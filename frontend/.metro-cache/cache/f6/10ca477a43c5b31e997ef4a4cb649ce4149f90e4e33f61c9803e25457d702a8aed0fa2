{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  exports.__esModule = true;\n  exports.default = performJoins;\n  function performJoinsImpl(query, performer) {\n    if (!query) {\n      return query;\n    } else if (query.$join) {\n      var _ref;\n      var _join = query.$join;\n      var joinQuery = performJoinsImpl(_join.query, performer);\n      _join.query = joinQuery;\n      var records = performer(_join);\n\n      // for queries on `belongs_to` tables, matchingIds will be IDs of the parent table records\n      //   (e.g. task: { project_id in ids })\n      // and for `has_many` tables, it will be IDs of the main table records\n      //   (e.g. task: { id in (ids from tag_assignment.task_id) })\n      var matchingIds = records.map(function (record) {\n        return record[_join.mapKey];\n      });\n      return _ref = {}, _ref[_join.joinKey] = {\n        $in: matchingIds\n      }, _ref;\n    } else if (query.$and) {\n      return {\n        $and: query.$and.map(function (clause) {\n          return performJoinsImpl(clause, performer);\n        })\n      };\n    } else if (query.$or) {\n      return {\n        $or: query.$or.map(function (clause) {\n          return performJoinsImpl(clause, performer);\n        })\n      };\n    }\n    return query;\n  }\n  function performJoins(lokiQuery, performer) {\n    var {\n      query: query,\n      hasJoins: hasJoins\n    } = lokiQuery;\n    if (!hasJoins) {\n      return query;\n    }\n    return performJoinsImpl(query, performer);\n  }\n});","lineCount":51,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"exports"],[4,9,3,7],[4,10,3,8,"__esModule"],[4,20,3,18],[4,23,3,21],[4,27,3,25],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"default"],[5,17,4,15],[5,20,4,18,"performJoins"],[5,32,4,30],[6,2,5,0],[6,11,5,9,"performJoinsImpl"],[6,27,5,25,"performJoinsImpl"],[6,28,5,26,"query"],[6,33,5,31],[6,35,5,33,"performer"],[6,44,5,42],[6,46,5,44],[7,4,6,2],[7,8,6,6],[7,9,6,7,"query"],[7,14,6,12],[7,16,6,14],[8,6,7,4],[8,13,7,11,"query"],[8,18,7,16],[9,4,8,2],[9,5,8,3],[9,11,8,9],[9,15,8,13,"query"],[9,20,8,18],[9,21,8,19,"$join"],[9,26,8,24],[9,28,8,26],[10,6,9,4],[10,10,9,8,"_ref"],[10,14,9,12],[11,6,10,4],[11,10,10,8,"_join"],[11,15,10,13],[11,18,10,16,"query"],[11,23,10,21],[11,24,10,22,"$join"],[11,29,10,27],[12,6,11,4],[12,10,11,8,"joinQuery"],[12,19,11,17],[12,22,11,20,"performJoinsImpl"],[12,38,11,36],[12,39,11,37,"_join"],[12,44,11,42],[12,45,11,43,"query"],[12,50,11,48],[12,52,11,50,"performer"],[12,61,11,59],[12,62,11,60],[13,6,12,4,"_join"],[13,11,12,9],[13,12,12,10,"query"],[13,17,12,15],[13,20,12,18,"joinQuery"],[13,29,12,27],[14,6,13,4],[14,10,13,8,"records"],[14,17,13,15],[14,20,13,18,"performer"],[14,29,13,27],[14,30,13,28,"_join"],[14,35,13,33],[14,36,13,34],[16,6,15,4],[17,6,16,4],[18,6,17,4],[19,6,18,4],[20,6,19,4],[20,10,19,8,"matchingIds"],[20,21,19,19],[20,24,19,22,"records"],[20,31,19,29],[20,32,19,30,"map"],[20,35,19,33],[20,36,19,34],[20,46,19,44,"record"],[20,52,19,50],[20,54,19,52],[21,8,20,6],[21,15,20,13,"record"],[21,21,20,19],[21,22,20,20,"_join"],[21,27,20,25],[21,28,20,26,"mapKey"],[21,34,20,32],[21,35,20,33],[22,6,21,4],[22,7,21,5],[22,8,21,6],[23,6,22,4],[23,13,22,11,"_ref"],[23,17,22,15],[23,20,22,18],[23,21,22,19],[23,22,22,20],[23,24,22,22,"_ref"],[23,28,22,26],[23,29,22,27,"_join"],[23,34,22,32],[23,35,22,33,"joinKey"],[23,42,22,40],[23,43,22,41],[23,46,22,44],[24,8,23,6,"$in"],[24,11,23,9],[24,13,23,11,"matchingIds"],[25,6,24,4],[25,7,24,5],[25,9,24,7,"_ref"],[25,13,24,11],[26,4,25,2],[26,5,25,3],[26,11,25,9],[26,15,25,13,"query"],[26,20,25,18],[26,21,25,19,"$and"],[26,25,25,23],[26,27,25,25],[27,6,26,4],[27,13,26,11],[28,8,27,6,"$and"],[28,12,27,10],[28,14,27,12,"query"],[28,19,27,17],[28,20,27,18,"$and"],[28,24,27,22],[28,25,27,23,"map"],[28,28,27,26],[28,29,27,27],[28,39,27,37,"clause"],[28,45,27,43],[28,47,27,45],[29,10,28,8],[29,17,28,15,"performJoinsImpl"],[29,33,28,31],[29,34,28,32,"clause"],[29,40,28,38],[29,42,28,40,"performer"],[29,51,28,49],[29,52,28,50],[30,8,29,6],[30,9,29,7],[31,6,30,4],[31,7,30,5],[32,4,31,2],[32,5,31,3],[32,11,31,9],[32,15,31,13,"query"],[32,20,31,18],[32,21,31,19,"$or"],[32,24,31,22],[32,26,31,24],[33,6,32,4],[33,13,32,11],[34,8,33,6,"$or"],[34,11,33,9],[34,13,33,11,"query"],[34,18,33,16],[34,19,33,17,"$or"],[34,22,33,20],[34,23,33,21,"map"],[34,26,33,24],[34,27,33,25],[34,37,33,35,"clause"],[34,43,33,41],[34,45,33,43],[35,10,34,8],[35,17,34,15,"performJoinsImpl"],[35,33,34,31],[35,34,34,32,"clause"],[35,40,34,38],[35,42,34,40,"performer"],[35,51,34,49],[35,52,34,50],[36,8,35,6],[36,9,35,7],[37,6,36,4],[37,7,36,5],[38,4,37,2],[39,4,38,2],[39,11,38,9,"query"],[39,16,38,14],[40,2,39,0],[41,2,40,0],[41,11,40,9,"performJoins"],[41,23,40,21,"performJoins"],[41,24,40,22,"lokiQuery"],[41,33,40,31],[41,35,40,33,"performer"],[41,44,40,42],[41,46,40,44],[42,4,41,2],[42,8,41,6],[43,6,42,4,"query"],[43,11,42,9],[43,13,42,11,"query"],[43,18,42,16],[44,6,43,4,"hasJoins"],[44,14,43,12],[44,16,43,14,"hasJoins"],[45,4,44,2],[45,5,44,3],[45,8,44,6,"lokiQuery"],[45,17,44,15],[46,4,45,2],[46,8,45,6],[46,9,45,7,"hasJoins"],[46,17,45,15],[46,19,45,17],[47,6,46,4],[47,13,46,11,"query"],[47,18,46,16],[48,4,47,2],[49,4,48,2],[49,11,48,9,"performJoinsImpl"],[49,27,48,25],[49,28,48,26,"query"],[49,33,48,31],[49,35,48,33,"performer"],[49,44,48,42],[49,45,48,43],[50,2,49,0],[51,0,49,1],[51,3]],"functionMap":{"names":["<global>","performJoinsImpl","records.map$argument_0","query.$and.map$argument_0","query.$or.map$argument_0","performJoins"],"mappings":"AAA;ACI;kCCc;KDE;2BEM;OFE;yBGI;OHE;CDI;AKC"},"hasCjsExports":true},"type":"js/module"}]}