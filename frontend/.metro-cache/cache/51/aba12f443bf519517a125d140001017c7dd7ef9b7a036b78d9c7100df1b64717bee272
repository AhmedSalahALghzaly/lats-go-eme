{"dependencies":[{"name":"../../utils/common","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":14,"index":125},"end":{"line":6,"column":43,"index":154}}],"key":"f8rxJKsVH8u9Uvy41cjr6BETN6o=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  exports.__esModule = true;\n  exports.default = void 0;\n  exports.localStorageKey = localStorageKey;\n  var _common = require(_dependencyMap[0], \"../../utils/common\");\n  function localStorageKey(name) {\n    return name;\n  }\n  var LocalStorage = exports.default = /*#__PURE__*/function () {\n    function LocalStorage(database) {\n      this._db = database;\n    }\n\n    // Get value from LocalStorage (returns value deserialized from JSON)\n    // Returns `undefined` if not found\n    var _proto = LocalStorage.prototype;\n    _proto.get = function (key) {\n      return new Promise(function ($return, $error) {\n        var json;\n        return Promise.resolve(this._db.adapter.getLocal(key)).then(function ($await_1) {\n          try {\n            json = $await_1;\n            return $return(null == json ? undefined : JSON.parse(json));\n          } catch ($boundEx) {\n            return $error($boundEx);\n          }\n        }, $error);\n      }.bind(this));\n    }\n\n    // Experimental: Same as get(), but can be called synchronously\n    ;\n    _proto._getSync = function (key, callback) {\n      this._db.adapter.underlyingAdapter.getLocal(key, function (result) {\n        var json = result.value ? result.value : undefined;\n        var value = null == json ? undefined : JSON.parse(json);\n        callback(value);\n      });\n    }\n\n    // Set value to LocalStorage\n    // Only JSON-serializable values are allowed and well-behaved:\n    // strings, numbers, booleans, and null; as well as arrays and objects only containing those\n    //\n    // Serializing other values will either throw an error (e.g. function passed) or be serialized\n    // such that deserializing it won't yield an equal value (e.g. NaN to null, Dates to a string)\n    // See details:\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#description\n    ;\n    _proto.set = function (key, value) {\n      return new Promise(function ($return) {\n        var json = JSON.stringify(value);\n        (0, _common.invariant)('string' === typeof json, 'Value not JSON-serializable');\n        return $return(this._db.adapter.setLocal(key, json));\n      }.bind(this));\n    };\n    _proto.remove = function (key) {\n      return new Promise(function ($return) {\n        return $return(this._db.adapter.removeLocal(key));\n      }.bind(this));\n    };\n    return LocalStorage;\n  }();\n});","lineCount":66,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"exports"],[4,9,3,7],[4,10,3,8,"__esModule"],[4,20,3,18],[4,23,3,21],[4,27,3,25],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"default"],[5,17,4,15],[5,20,4,18],[5,25,4,23],[5,26,4,24],[6,2,5,0,"exports"],[6,9,5,7],[6,10,5,8,"localStorageKey"],[6,25,5,23],[6,28,5,26,"localStorageKey"],[6,43,5,41],[7,2,6,0],[7,6,6,4,"_common"],[7,13,6,11],[7,16,6,14,"require"],[7,23,6,21],[7,24,6,21,"_dependencyMap"],[7,38,6,21],[7,63,6,42],[7,64,6,43],[8,2,7,0],[8,11,7,9,"localStorageKey"],[8,26,7,24,"localStorageKey"],[8,27,7,25,"name"],[8,31,7,29],[8,33,7,31],[9,4,8,2],[9,11,8,9,"name"],[9,15,8,13],[10,2,9,0],[11,2,10,0],[11,6,10,4,"LocalStorage"],[11,18,10,16],[11,21,10,19,"exports"],[11,28,10,26],[11,29,10,27,"default"],[11,36,10,34],[11,39,10,37],[11,52,10,50],[11,64,10,62],[12,4,11,2],[12,13,11,11,"LocalStorage"],[12,25,11,23,"LocalStorage"],[12,26,11,24,"database"],[12,34,11,32],[12,36,11,34],[13,6,12,4],[13,10,12,8],[13,11,12,9,"_db"],[13,14,12,12],[13,17,12,15,"database"],[13,25,12,23],[14,4,13,2],[16,4,15,2],[17,4,16,2],[18,4,17,2],[18,8,17,6,"_proto"],[18,14,17,12],[18,17,17,15,"LocalStorage"],[18,29,17,27],[18,30,17,28,"prototype"],[18,39,17,37],[19,4,18,2,"_proto"],[19,10,18,8],[19,11,18,9,"get"],[19,14,18,12],[19,17,18,15],[19,27,18,25,"key"],[19,30,18,28],[19,32,18,30],[20,6,19,4],[20,13,19,11],[20,17,19,15,"Promise"],[20,24,19,22],[20,25,19,23],[20,35,19,33,"$return"],[20,42,19,40],[20,44,19,42,"$error"],[20,50,19,48],[20,52,19,50],[21,8,20,6],[21,12,20,10,"json"],[21,16,20,14],[22,8,21,6],[22,15,21,13,"Promise"],[22,22,21,20],[22,23,21,21,"resolve"],[22,30,21,28],[22,31,21,29],[22,35,21,33],[22,36,21,34,"_db"],[22,39,21,37],[22,40,21,38,"adapter"],[22,47,21,45],[22,48,21,46,"getLocal"],[22,56,21,54],[22,57,21,55,"key"],[22,60,21,58],[22,61,21,59],[22,62,21,60],[22,63,21,61,"then"],[22,67,21,65],[22,68,21,66],[22,78,21,76,"$await_1"],[22,86,21,84],[22,88,21,86],[23,10,22,8],[23,14,22,12],[24,12,23,10,"json"],[24,16,23,14],[24,19,23,17,"$await_1"],[24,27,23,25],[25,12,24,10],[25,19,24,17,"$return"],[25,26,24,24],[25,27,24,25],[25,31,24,29],[25,35,24,33,"json"],[25,39,24,37],[25,42,24,40,"undefined"],[25,51,24,49],[25,54,24,52,"JSON"],[25,58,24,56],[25,59,24,57,"parse"],[25,64,24,62],[25,65,24,63,"json"],[25,69,24,67],[25,70,24,68],[25,71,24,69],[26,10,25,8],[26,11,25,9],[26,12,25,10],[26,19,25,17,"$boundEx"],[26,27,25,25],[26,29,25,27],[27,12,26,10],[27,19,26,17,"$error"],[27,25,26,23],[27,26,26,24,"$boundEx"],[27,34,26,32],[27,35,26,33],[28,10,27,8],[29,8,28,6],[29,9,28,7],[29,11,28,9,"$error"],[29,17,28,15],[29,18,28,16],[30,6,29,4],[30,7,29,5],[30,8,29,6,"bind"],[30,12,29,10],[30,13,29,11],[30,17,29,15],[30,18,29,16],[30,19,29,17],[31,4,30,2],[33,4,32,2],[34,4,32,2],[35,4,34,2,"_proto"],[35,10,34,8],[35,11,34,9,"_getSync"],[35,19,34,17],[35,22,34,20],[35,32,34,30,"key"],[35,35,34,33],[35,37,34,35,"callback"],[35,45,34,43],[35,47,34,45],[36,6,35,4],[36,10,35,8],[36,11,35,9,"_db"],[36,14,35,12],[36,15,35,13,"adapter"],[36,22,35,20],[36,23,35,21,"underlyingAdapter"],[36,40,35,38],[36,41,35,39,"getLocal"],[36,49,35,47],[36,50,35,48,"key"],[36,53,35,51],[36,55,35,53],[36,65,35,63,"result"],[36,71,35,69],[36,73,35,71],[37,8,36,6],[37,12,36,10,"json"],[37,16,36,14],[37,19,36,17,"result"],[37,25,36,23],[37,26,36,24,"value"],[37,31,36,29],[37,34,36,32,"result"],[37,40,36,38],[37,41,36,39,"value"],[37,46,36,44],[37,49,36,47,"undefined"],[37,58,36,56],[38,8,37,6],[38,12,37,10,"value"],[38,17,37,15],[38,20,37,18],[38,24,37,22],[38,28,37,26,"json"],[38,32,37,30],[38,35,37,33,"undefined"],[38,44,37,42],[38,47,37,45,"JSON"],[38,51,37,49],[38,52,37,50,"parse"],[38,57,37,55],[38,58,37,56,"json"],[38,62,37,60],[38,63,37,61],[39,8,38,6,"callback"],[39,16,38,14],[39,17,38,15,"value"],[39,22,38,20],[39,23,38,21],[40,6,39,4],[40,7,39,5],[40,8,39,6],[41,4,40,2],[43,4,42,2],[44,4,43,2],[45,4,44,2],[46,4,45,2],[47,4,46,2],[48,4,47,2],[49,4,48,2],[50,4,49,2],[51,4,49,2],[52,4,51,2,"_proto"],[52,10,51,8],[52,11,51,9,"set"],[52,14,51,12],[52,17,51,15],[52,27,51,25,"key"],[52,30,51,28],[52,32,51,30,"value"],[52,37,51,35],[52,39,51,37],[53,6,52,4],[53,13,52,11],[53,17,52,15,"Promise"],[53,24,52,22],[53,25,52,23],[53,35,52,33,"$return"],[53,42,52,40],[53,44,52,42],[54,8,53,6],[54,12,53,10,"json"],[54,16,53,14],[54,19,53,17,"JSON"],[54,23,53,21],[54,24,53,22,"stringify"],[54,33,53,31],[54,34,53,32,"value"],[54,39,53,37],[54,40,53,38],[55,8,54,6],[55,9,54,7],[55,10,54,8],[55,12,54,10,"_common"],[55,19,54,17],[55,20,54,18,"invariant"],[55,29,54,27],[55,31,54,29],[55,39,54,37],[55,44,54,42],[55,51,54,49,"json"],[55,55,54,53],[55,57,54,55],[55,86,54,84],[55,87,54,85],[56,8,55,6],[56,15,55,13,"$return"],[56,22,55,20],[56,23,55,21],[56,27,55,25],[56,28,55,26,"_db"],[56,31,55,29],[56,32,55,30,"adapter"],[56,39,55,37],[56,40,55,38,"setLocal"],[56,48,55,46],[56,49,55,47,"key"],[56,52,55,50],[56,54,55,52,"json"],[56,58,55,56],[56,59,55,57],[56,60,55,58],[57,6,56,4],[57,7,56,5],[57,8,56,6,"bind"],[57,12,56,10],[57,13,56,11],[57,17,56,15],[57,18,56,16],[57,19,56,17],[58,4,57,2],[58,5,57,3],[59,4,58,2,"_proto"],[59,10,58,8],[59,11,58,9,"remove"],[59,17,58,15],[59,20,58,18],[59,30,58,28,"key"],[59,33,58,31],[59,35,58,33],[60,6,59,4],[60,13,59,11],[60,17,59,15,"Promise"],[60,24,59,22],[60,25,59,23],[60,35,59,33,"$return"],[60,42,59,40],[60,44,59,42],[61,8,60,6],[61,15,60,13,"$return"],[61,22,60,20],[61,23,60,21],[61,27,60,25],[61,28,60,26,"_db"],[61,31,60,29],[61,32,60,30,"adapter"],[61,39,60,37],[61,40,60,38,"removeLocal"],[61,51,60,49],[61,52,60,50,"key"],[61,55,60,53],[61,56,60,54],[61,57,60,55],[62,6,61,4],[62,7,61,5],[62,8,61,6,"bind"],[62,12,61,10],[62,13,61,11],[62,17,61,15],[62,18,61,16],[62,19,61,17],[63,4,62,2],[63,5,62,3],[64,4,63,2],[64,11,63,9,"LocalStorage"],[64,23,63,21],[65,2,64,0],[65,3,64,1],[65,4,64,2],[65,5,64,3],[66,0,64,4],[66,3]],"functionMap":{"names":["<global>","localStorageKey","<anonymous>","LocalStorage","_proto.get","Promise.resolve.then$argument_0","_proto._getSync","_db.adapter.underlyingAdapter.getLocal$argument_1","_proto.set","_proto.remove"],"mappings":"AAA;ACM;CDE;kDEC;ECC;GDE;eEK;uBFC;kEGE;OHO;KEC;GFC;oBII;qDCC;KDI;GJC;eMW;uBNC;KMI;GNC;kBOC;uBPC;KOE;GPC;CFE"},"hasCjsExports":true},"type":"js/module"}]}