{"dependencies":[{"name":"./worker/loki.worker","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":24,"index":152},"end":{"line":7,"column":55,"index":183}}],"key":"TTeX3BP+GT2W9Q9Jc7GBQtFpoXM=","exportNames":["*"],"imports":1}},{"name":"./worker/synchronousWorker","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":30,"index":251},"end":{"line":10,"column":67,"index":288}}],"key":"GAvoztH2cL6+xfk6i/OAUi4Ha1g=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  exports.__esModule = true;\n  exports.default = void 0;\n  function createWorker(useWebWorker) {\n    if (useWebWorker) {\n      var LokiWebWorker = require(_dependencyMap[0], \"./worker/loki.worker\");\n      return new LokiWebWorker();\n    }\n    var LokiSynchronousWorker = require(_dependencyMap[1], \"./worker/synchronousWorker\").default;\n    return new LokiSynchronousWorker();\n  }\n  var _actionId = 0;\n  function nextActionId() {\n    _actionId += 1;\n    return _actionId;\n  }\n  var LokiDispatcher = exports.default = /*#__PURE__*/function () {\n    function LokiDispatcher(useWebWorker) {\n      var _this = this;\n      this._pendingCalls = [];\n      this._worker = createWorker(useWebWorker);\n      this._worker.onmessage = function (_ref) {\n        var data = _ref.data;\n        var result = data.result,\n          responseId = data.id;\n        var _this$_pendingCalls$s = _this._pendingCalls.shift(),\n          callback = _this$_pendingCalls$s.callback,\n          id = _this$_pendingCalls$s.id;\n\n        // sanity check\n        if (id !== responseId) {\n          callback({\n            error: new Error('Loki worker responses are out of order')\n          });\n          return;\n        }\n        callback(result);\n      };\n    }\n\n    // TODO: `any` return should be `WorkerResponsePayload`\n    var _proto = LokiDispatcher.prototype;\n    _proto.call = function (type) {\n      var payload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n      var cloneMethod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'immutable';\n      var returnCloneMethod = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'immutable';\n      var id = nextActionId();\n      this._pendingCalls.push({\n        callback: callback,\n        id: id\n      });\n      this._worker.postMessage({\n        id: id,\n        type: type,\n        payload: payload,\n        cloneMethod: cloneMethod,\n        returnCloneMethod: returnCloneMethod\n      });\n    };\n    return LokiDispatcher;\n  }();\n});","lineCount":65,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"exports"],[4,9,3,7],[4,10,3,8,"__esModule"],[4,20,3,18],[4,23,3,21],[4,27,3,25],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"default"],[5,17,4,15],[5,20,4,18],[5,25,4,23],[5,26,4,24],[6,2,5,0],[6,11,5,9,"createWorker"],[6,23,5,21,"createWorker"],[6,24,5,22,"useWebWorker"],[6,36,5,34],[6,38,5,36],[7,4,6,2],[7,8,6,6,"useWebWorker"],[7,20,6,18],[7,22,6,20],[8,6,7,4],[8,10,7,8,"LokiWebWorker"],[8,23,7,21],[8,26,7,24,"require"],[8,33,7,31],[8,34,7,31,"_dependencyMap"],[8,48,7,31],[8,75,7,54],[8,76,7,55],[9,6,8,4],[9,13,8,11],[9,17,8,15,"LokiWebWorker"],[9,30,8,28],[9,31,8,29],[9,32,8,30],[10,4,9,2],[11,4,10,2],[11,8,10,6,"LokiSynchronousWorker"],[11,29,10,27],[11,32,10,30,"require"],[11,39,10,37],[11,40,10,37,"_dependencyMap"],[11,54,10,37],[11,87,10,66],[11,88,10,67],[11,89,10,68,"default"],[11,96,10,75],[12,4,11,2],[12,11,11,9],[12,15,11,13,"LokiSynchronousWorker"],[12,36,11,34],[12,37,11,35],[12,38,11,36],[13,2,12,0],[14,2,13,0],[14,6,13,4,"_actionId"],[14,15,13,13],[14,18,13,16],[14,19,13,17],[15,2,14,0],[15,11,14,9,"nextActionId"],[15,23,14,21,"nextActionId"],[15,24,14,21],[15,26,14,24],[16,4,15,2,"_actionId"],[16,13,15,11],[16,17,15,15],[16,18,15,16],[17,4,16,2],[17,11,16,9,"_actionId"],[17,20,16,18],[18,2,17,0],[19,2,18,0],[19,6,18,4,"LokiDispatcher"],[19,20,18,18],[19,23,18,21,"exports"],[19,30,18,28],[19,31,18,29,"default"],[19,38,18,36],[19,41,18,39],[19,54,18,52],[19,66,18,64],[20,4,19,2],[20,13,19,11,"LokiDispatcher"],[20,27,19,25,"LokiDispatcher"],[20,28,19,26,"useWebWorker"],[20,40,19,38],[20,42,19,40],[21,6,20,4],[21,10,20,8,"_this"],[21,15,20,13],[21,18,20,16],[21,22,20,20],[22,6,21,4],[22,10,21,8],[22,11,21,9,"_pendingCalls"],[22,24,21,22],[22,27,21,25],[22,29,21,27],[23,6,22,4],[23,10,22,8],[23,11,22,9,"_worker"],[23,18,22,16],[23,21,22,19,"createWorker"],[23,33,22,31],[23,34,22,32,"useWebWorker"],[23,46,22,44],[23,47,22,45],[24,6,23,4],[24,10,23,8],[24,11,23,9,"_worker"],[24,18,23,16],[24,19,23,17,"onmessage"],[24,28,23,26],[24,31,23,29],[24,41,23,29,"_ref"],[24,45,23,29],[24,47,25,7],[25,8,25,7],[25,12,24,12,"data"],[25,16,24,16],[25,19,24,16,"_ref"],[25,23,24,16],[25,24,24,6,"data"],[25,28,24,10],[26,8,26,6],[26,12,27,16,"result"],[26,18,27,22],[26,21,29,10,"data"],[26,25,29,14],[26,26,27,8,"result"],[26,32,27,14],[27,10,28,12,"responseId"],[27,20,28,22],[27,23,29,10,"data"],[27,27,29,14],[27,28,28,8,"id"],[27,30,28,10],[28,8,30,6],[28,12,30,6,"_this$_pendingCalls$s"],[28,33,30,6],[28,36,33,10,"_this"],[28,41,33,15],[28,42,33,16,"_pendingCalls"],[28,55,33,29],[28,56,33,30,"shift"],[28,61,33,35],[28,62,33,36],[28,63,33,37],[29,10,31,18,"callback"],[29,18,31,26],[29,21,31,26,"_this$_pendingCalls$s"],[29,42,31,26],[29,43,31,8,"callback"],[29,51,31,16],[30,10,32,12,"id"],[30,12,32,14],[30,15,32,14,"_this$_pendingCalls$s"],[30,36,32,14],[30,37,32,8,"id"],[30,39,32,10],[32,8,35,6],[33,8,36,6],[33,12,36,10,"id"],[33,14,36,12],[33,19,36,17,"responseId"],[33,29,36,27],[33,31,36,29],[34,10,37,8,"callback"],[34,18,37,16],[34,19,37,17],[35,12,38,10,"error"],[35,17,38,15],[35,19,38,17],[35,23,38,21,"Error"],[35,28,38,26],[35,29,38,27],[35,69,38,67],[36,10,39,8],[36,11,39,9],[36,12,39,10],[37,10,40,8],[38,8,41,6],[39,8,42,6,"callback"],[39,16,42,14],[39,17,42,15,"result"],[39,23,42,21],[39,24,42,22],[40,6,43,4],[40,7,43,5],[41,4,44,2],[43,4,46,2],[44,4,47,2],[44,8,47,6,"_proto"],[44,14,47,12],[44,17,47,15,"LokiDispatcher"],[44,31,47,29],[44,32,47,30,"prototype"],[44,41,47,39],[45,4,48,2,"_proto"],[45,10,48,8],[45,11,48,9,"call"],[45,15,48,13],[45,18,48,16],[45,28,48,26,"type"],[45,32,48,30],[45,34,50,62],[46,6,50,62],[46,10,48,32,"payload"],[46,17,48,39],[46,20,48,39,"arguments"],[46,29,48,39],[46,30,48,39,"length"],[46,36,48,39],[46,44,48,39,"arguments"],[46,53,48,39],[46,61,48,39,"undefined"],[46,70,48,39],[46,73,48,39,"arguments"],[46,82,48,39],[46,88,48,42],[46,90,48,44],[47,6,48,44],[47,10,48,46,"callback"],[47,18,48,54],[47,21,48,54,"arguments"],[47,30,48,54],[47,31,48,54,"length"],[47,37,48,54],[47,45,48,54,"arguments"],[47,54,48,54],[47,62,48,54,"undefined"],[47,71,48,54],[47,74,48,54,"arguments"],[47,83,48,54],[47,89,48,57],[47,101,48,69],[47,102,48,70],[47,103,48,71],[48,6,48,71],[48,10,50,2,"cloneMethod"],[48,21,50,13],[48,24,50,13,"arguments"],[48,33,50,13],[48,34,50,13,"length"],[48,40,50,13],[48,48,50,13,"arguments"],[48,57,50,13],[48,65,50,13,"undefined"],[48,74,50,13],[48,77,50,13,"arguments"],[48,86,50,13],[48,92,50,16],[48,103,50,27],[49,6,50,27],[49,10,50,29,"returnCloneMethod"],[49,27,50,46],[49,30,50,46,"arguments"],[49,39,50,46],[49,40,50,46,"length"],[49,46,50,46],[49,54,50,46,"arguments"],[49,63,50,46],[49,71,50,46,"undefined"],[49,80,50,46],[49,83,50,46,"arguments"],[49,92,50,46],[49,98,50,49],[49,109,50,60],[50,6,51,4],[50,10,51,8,"id"],[50,12,51,10],[50,15,51,13,"nextActionId"],[50,27,51,25],[50,28,51,26],[50,29,51,27],[51,6,52,4],[51,10,52,8],[51,11,52,9,"_pendingCalls"],[51,24,52,22],[51,25,52,23,"push"],[51,29,52,27],[51,30,52,28],[52,8,53,6,"callback"],[52,16,53,14],[52,18,53,16,"callback"],[52,26,53,24],[53,8,54,6,"id"],[53,10,54,8],[53,12,54,10,"id"],[54,6,55,4],[54,7,55,5],[54,8,55,6],[55,6,56,4],[55,10,56,8],[55,11,56,9,"_worker"],[55,18,56,16],[55,19,56,17,"postMessage"],[55,30,56,28],[55,31,56,29],[56,8,57,6,"id"],[56,10,57,8],[56,12,57,10,"id"],[56,14,57,12],[57,8,58,6,"type"],[57,12,58,10],[57,14,58,12,"type"],[57,18,58,16],[58,8,59,6,"payload"],[58,15,59,13],[58,17,59,15,"payload"],[58,24,59,22],[59,8,60,6,"cloneMethod"],[59,19,60,17],[59,21,60,19,"cloneMethod"],[59,32,60,30],[60,8,61,6,"returnCloneMethod"],[60,25,61,23],[60,27,61,25,"returnCloneMethod"],[61,6,62,4],[61,7,62,5],[61,8,62,6],[62,4,63,2],[62,5,63,3],[63,4,64,2],[63,11,64,9,"LokiDispatcher"],[63,25,64,23],[64,2,65,0],[64,3,65,1],[64,4,65,2],[64,5,65,3],[65,0,65,4],[65,3]],"functionMap":{"names":["<global>","createWorker","nextActionId","<anonymous>","LokiDispatcher","_worker.onmessage","_proto.call"],"mappings":"AAA;ACI;CDO;AEE;CFG;oDGC;ECC;6BCI;KDoB;GDC;gBGI,yCH,cG;GHe;CHE"},"hasCjsExports":true},"type":"js/module"}]}