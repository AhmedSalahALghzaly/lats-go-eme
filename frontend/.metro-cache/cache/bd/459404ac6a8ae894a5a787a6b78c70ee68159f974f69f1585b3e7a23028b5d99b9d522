{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":29,"index":44},"end":{"line":3,"column":84,"index":99}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"../../common/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":40,"index":194},"end":{"line":6,"column":73,"index":227}}],"key":"Lyt2WLsYCohNU3fs70uAtDNxU1A=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  exports.__esModule = true;\n  exports.default = void 0;\n  var _invariant = _interopRequireDefault(require(_dependencyMap[1], \"../../common/invariant\"));\n  // A subscribable that implements the equivalent of:\n  // multicast(() => new ReplaySubject(1)) |> refCount Rx operation\n  //\n  // In other words:\n  // - Upon subscription, the source subscribable is subscribed to,\n  //   and its notifications are passed to subscribers here.\n  // - Multiple subscribers only cause a single subscription of the source\n  // - When last subscriber unsubscribes, the source is unsubscribed\n  // - Upon subscription, the subscriber receives last value sent by source (if any)\n  var SharedSubscribable = exports.default = /*#__PURE__*/function () {\n    function SharedSubscribable(source) {\n      this._unsubscribeSource = null;\n      this._subscribers = [];\n      this._didEmit = false;\n      this._lastValue = null;\n      this._source = source;\n    }\n    var _proto = SharedSubscribable.prototype;\n    _proto.subscribe = function (subscriber, debugInfo) {\n      var _this = this;\n      var entry = [subscriber, debugInfo];\n      this._subscribers.push(entry);\n      if (this._didEmit) {\n        subscriber(this._lastValue);\n      }\n      if (1 === this._subscribers.length) {\n        // TODO: What if this throws?\n        this._unsubscribeSource = this._source(function (value) {\n          return _this._notify(value);\n        });\n      }\n      return function () {\n        return _this._unsubscribe(entry);\n      };\n    };\n    _proto._notify = function (value) {\n      (0, _invariant.default)(this._subscribers.length, \"SharedSubscribable's source emitted a value after it was unsubscribed from\");\n      this._didEmit = true;\n      this._lastValue = value;\n      this._subscribers.forEach(function ([subscriber]) {\n        subscriber(value);\n      });\n    };\n    _proto._unsubscribe = function (entry) {\n      var idx = this._subscribers.indexOf(entry);\n      -1 !== idx && this._subscribers.splice(idx, 1);\n      if (!this._subscribers.length) {\n        var unsubscribe = this._unsubscribeSource;\n        this._unsubscribeSource = null;\n        this._didEmit = false;\n        unsubscribe && unsubscribe();\n      }\n    };\n    return SharedSubscribable;\n  }();\n});","lineCount":63,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"_interopRequireDefault"],[4,28,3,26],[4,31,3,29,"require"],[4,38,3,36],[4,39,3,36,"_dependencyMap"],[4,53,3,36],[4,104,3,83],[4,105,3,84],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"__esModule"],[5,20,4,18],[5,23,4,21],[5,27,4,25],[6,2,5,0,"exports"],[6,9,5,7],[6,10,5,8,"default"],[6,17,5,15],[6,20,5,18],[6,25,5,23],[6,26,5,24],[7,2,6,0],[7,6,6,4,"_invariant"],[7,16,6,14],[7,19,6,17,"_interopRequireDefault"],[7,41,6,39],[7,42,6,40,"require"],[7,49,6,47],[7,50,6,47,"_dependencyMap"],[7,64,6,47],[7,93,6,72],[7,94,6,73],[7,95,6,74],[8,2,7,0],[9,2,8,0],[10,2,9,0],[11,2,10,0],[12,2,11,0],[13,2,12,0],[14,2,13,0],[15,2,14,0],[16,2,15,0],[17,2,16,0],[17,6,16,4,"SharedSubscribable"],[17,24,16,22],[17,27,16,25,"exports"],[17,34,16,32],[17,35,16,33,"default"],[17,42,16,40],[17,45,16,43],[17,58,16,56],[17,70,16,68],[18,4,17,2],[18,13,17,11,"SharedSubscribable"],[18,31,17,29,"SharedSubscribable"],[18,32,17,30,"source"],[18,38,17,36],[18,40,17,38],[19,6,18,4],[19,10,18,8],[19,11,18,9,"_unsubscribeSource"],[19,29,18,27],[19,32,18,30],[19,36,18,34],[20,6,19,4],[20,10,19,8],[20,11,19,9,"_subscribers"],[20,23,19,21],[20,26,19,24],[20,28,19,26],[21,6,20,4],[21,10,20,8],[21,11,20,9,"_didEmit"],[21,19,20,17],[21,22,20,20],[21,27,20,25],[22,6,21,4],[22,10,21,8],[22,11,21,9,"_lastValue"],[22,21,21,19],[22,24,21,22],[22,28,21,26],[23,6,22,4],[23,10,22,8],[23,11,22,9,"_source"],[23,18,22,16],[23,21,22,19,"source"],[23,27,22,25],[24,4,23,2],[25,4,24,2],[25,8,24,6,"_proto"],[25,14,24,12],[25,17,24,15,"SharedSubscribable"],[25,35,24,33],[25,36,24,34,"prototype"],[25,45,24,43],[26,4,25,2,"_proto"],[26,10,25,8],[26,11,25,9,"subscribe"],[26,20,25,18],[26,23,25,21],[26,33,25,31,"subscriber"],[26,43,25,41],[26,45,25,43,"debugInfo"],[26,54,25,52],[26,56,25,54],[27,6,26,4],[27,10,26,8,"_this"],[27,15,26,13],[27,18,26,16],[27,22,26,20],[28,6,27,4],[28,10,27,8,"entry"],[28,15,27,13],[28,18,27,16],[28,19,27,17,"subscriber"],[28,29,27,27],[28,31,27,29,"debugInfo"],[28,40,27,38],[28,41,27,39],[29,6,28,4],[29,10,28,8],[29,11,28,9,"_subscribers"],[29,23,28,21],[29,24,28,22,"push"],[29,28,28,26],[29,29,28,27,"entry"],[29,34,28,32],[29,35,28,33],[30,6,29,4],[30,10,29,8],[30,14,29,12],[30,15,29,13,"_didEmit"],[30,23,29,21],[30,25,29,23],[31,8,30,6,"subscriber"],[31,18,30,16],[31,19,30,17],[31,23,30,21],[31,24,30,22,"_lastValue"],[31,34,30,32],[31,35,30,33],[32,6,31,4],[33,6,32,4],[33,10,32,8],[33,11,32,9],[33,16,32,14],[33,20,32,18],[33,21,32,19,"_subscribers"],[33,33,32,31],[33,34,32,32,"length"],[33,40,32,38],[33,42,32,40],[34,8,33,6],[35,8,34,6],[35,12,34,10],[35,13,34,11,"_unsubscribeSource"],[35,31,34,29],[35,34,34,32],[35,38,34,36],[35,39,34,37,"_source"],[35,46,34,44],[35,47,34,45],[35,57,34,55,"value"],[35,62,34,60],[35,64,34,62],[36,10,35,8],[36,17,35,15,"_this"],[36,22,35,20],[36,23,35,21,"_notify"],[36,30,35,28],[36,31,35,29,"value"],[36,36,35,34],[36,37,35,35],[37,8,36,6],[37,9,36,7],[37,10,36,8],[38,6,37,4],[39,6,38,4],[39,13,38,11],[39,25,38,23],[40,8,39,6],[40,15,39,13,"_this"],[40,20,39,18],[40,21,39,19,"_unsubscribe"],[40,33,39,31],[40,34,39,32,"entry"],[40,39,39,37],[40,40,39,38],[41,6,40,4],[41,7,40,5],[42,4,41,2],[42,5,41,3],[43,4,42,2,"_proto"],[43,10,42,8],[43,11,42,9,"_notify"],[43,18,42,16],[43,21,42,19],[43,31,42,29,"value"],[43,36,42,34],[43,38,42,36],[44,6,43,4],[44,7,43,5],[44,8,43,6],[44,10,43,8,"_invariant"],[44,20,43,18],[44,21,43,19,"default"],[44,28,43,26],[44,30,43,28],[44,34,43,32],[44,35,43,33,"_subscribers"],[44,47,43,45],[44,48,43,46,"length"],[44,54,43,52],[44,56,43,54],[44,132,43,130],[44,133,43,131],[45,6,44,4],[45,10,44,8],[45,11,44,9,"_didEmit"],[45,19,44,17],[45,22,44,20],[45,26,44,24],[46,6,45,4],[46,10,45,8],[46,11,45,9,"_lastValue"],[46,21,45,19],[46,24,45,22,"value"],[46,29,45,27],[47,6,46,4],[47,10,46,8],[47,11,46,9,"_subscribers"],[47,23,46,21],[47,24,46,22,"forEach"],[47,31,46,29],[47,32,46,30],[47,42,46,40],[47,43,46,41,"subscriber"],[47,53,46,51],[47,54,46,52],[47,56,46,54],[48,8,47,6,"subscriber"],[48,18,47,16],[48,19,47,17,"value"],[48,24,47,22],[48,25,47,23],[49,6,48,4],[49,7,48,5],[49,8,48,6],[50,4,49,2],[50,5,49,3],[51,4,50,2,"_proto"],[51,10,50,8],[51,11,50,9,"_unsubscribe"],[51,23,50,21],[51,26,50,24],[51,36,50,34,"entry"],[51,41,50,39],[51,43,50,41],[52,6,51,4],[52,10,51,8,"idx"],[52,13,51,11],[52,16,51,14],[52,20,51,18],[52,21,51,19,"_subscribers"],[52,33,51,31],[52,34,51,32,"indexOf"],[52,41,51,39],[52,42,51,40,"entry"],[52,47,51,45],[52,48,51,46],[53,6,52,4],[53,7,52,5],[53,8,52,6],[53,13,52,11,"idx"],[53,16,52,14],[53,20,52,18],[53,24,52,22],[53,25,52,23,"_subscribers"],[53,37,52,35],[53,38,52,36,"splice"],[53,44,52,42],[53,45,52,43,"idx"],[53,48,52,46],[53,50,52,48],[53,51,52,49],[53,52,52,50],[54,6,53,4],[54,10,53,8],[54,11,53,9],[54,15,53,13],[54,16,53,14,"_subscribers"],[54,28,53,26],[54,29,53,27,"length"],[54,35,53,33],[54,37,53,35],[55,8,54,6],[55,12,54,10,"unsubscribe"],[55,23,54,21],[55,26,54,24],[55,30,54,28],[55,31,54,29,"_unsubscribeSource"],[55,49,54,47],[56,8,55,6],[56,12,55,10],[56,13,55,11,"_unsubscribeSource"],[56,31,55,29],[56,34,55,32],[56,38,55,36],[57,8,56,6],[57,12,56,10],[57,13,56,11,"_didEmit"],[57,21,56,19],[57,24,56,22],[57,29,56,27],[58,8,57,6,"unsubscribe"],[58,19,57,17],[58,23,57,21,"unsubscribe"],[58,34,57,32],[58,35,57,33],[58,36,57,34],[59,6,58,4],[60,4,59,2],[60,5,59,3],[61,4,60,2],[61,11,60,9,"SharedSubscribable"],[61,29,60,27],[62,2,61,0],[62,3,61,1],[62,4,61,2],[62,5,61,3],[63,0,61,4],[63,3]],"functionMap":{"names":["<global>","<anonymous>","SharedSubscribable","_proto.subscribe","_source$argument_0","_proto._notify","_subscribers.forEach$argument_0","_proto._unsubscribe"],"mappings":"AAA;wDCe;ECC;GDM;qBEE;6CCS;ODE;WFE;KEE;GFC;mBIC;8BCI;KDE;GJC;wBMC;GNS;CDE"},"hasCjsExports":true},"type":"js/module"}]}