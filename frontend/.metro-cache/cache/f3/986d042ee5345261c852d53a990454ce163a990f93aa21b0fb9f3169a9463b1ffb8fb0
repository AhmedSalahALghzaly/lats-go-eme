{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":29,"index":44},"end":{"line":3,"column":84,"index":99}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"../../common/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":40,"index":197},"end":{"line":6,"column":73,"index":230}}],"key":"Lyt2WLsYCohNU3fs70uAtDNxU1A=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  exports.__esModule = true;\n  exports.default = checkName;\n  var _invariant = _interopRequireDefault(require(_dependencyMap[1], \"../../common/invariant\"));\n  // Asserts that `name` (table or column name) should be safe for inclusion in SQL queries\n  // and Loki queries (JS objects)\n  //\n  // IMPORTANT: This should NEVER be used as the only line of defense! These checks may be incomplete.\n  // Any table or column name passed anywhere near the database should be hardcoded or whitelisted.\n  // This is a \"defense in depth\" type of check - checking for common mistakes in case library user\n  // is not following safe coding practices or the primary defense fails.\n  //\n  // This will throw an error on:\n  // - JavaScript Object prototype properties\n  // - Magic Loki and SQLite column names\n  // - names starting with __\n  // - names that are not essentially alphanumeric\n  //\n  // Note that for SQL, you always MUST wrap table/column names with `'name'`, otherwise query may fail\n  // for some keywords\n  //\n  // Note that this doesn't throw for Watermelon builtins (id, _changed, _status...)\n  var safeNameCharacters = /^[a-zA-Z_]\\w*$/;\n  var knownSafeNames = new Set();\n  function checkName(name) {\n    if (knownSafeNames.has(name)) {\n      return name;\n    }\n    (0, _invariant.default)('string' === typeof name, \"Unsafe name '\".concat(name, \"' not allowed (not a string)\"));\n    (0, _invariant.default)(!['__proto__', 'constructor', 'prototype', 'hasOwnProperty', 'isPrototypeOf', 'toString', 'toLocaleString', 'valueOf'].includes(name), \"Unsafe name '\".concat(name, \"' not allowed (Object prototype property)\"));\n    (0, _invariant.default)('$loki' !== name.toLowerCase(), \"Unsafe name '\".concat(name, \"' not allowed (reserved for LokiJS compatibility)\"));\n    (0, _invariant.default)(!['rowid', 'oid', '_rowid_', 'sqlite_master'].includes(name.toLowerCase()), \"Unsafe name '\".concat(name, \"' not allowed (reserved for SQLite compatibility)\"));\n    (0, _invariant.default)(!name.toLowerCase().startsWith('sqlite_stat'), \"Unsafe name '\".concat(name, \"' not allowed (reserved for SQLite compatibility)\"));\n    (0, _invariant.default)(!name.startsWith('__'), \"Unsafe name '\".concat(name, \"' not allowed (names starting with '__' are reserved for internal purposes)\"));\n    (0, _invariant.default)(safeNameCharacters.test(name), \"Unsafe name '\".concat(name, \"' not allowed (names must contain only safe characters \").concat(safeNameCharacters.toString(), \")\"));\n    knownSafeNames.add(name);\n    return name;\n  }\n});","lineCount":42,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"_interopRequireDefault"],[4,28,3,26],[4,31,3,29,"require"],[4,38,3,36],[4,39,3,36,"_dependencyMap"],[4,53,3,36],[4,104,3,83],[4,105,3,84],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"__esModule"],[5,20,4,18],[5,23,4,21],[5,27,4,25],[6,2,5,0,"exports"],[6,9,5,7],[6,10,5,8,"default"],[6,17,5,15],[6,20,5,18,"checkName"],[6,29,5,27],[7,2,6,0],[7,6,6,4,"_invariant"],[7,16,6,14],[7,19,6,17,"_interopRequireDefault"],[7,41,6,39],[7,42,6,40,"require"],[7,49,6,47],[7,50,6,47,"_dependencyMap"],[7,64,6,47],[7,93,6,72],[7,94,6,73],[7,95,6,74],[8,2,7,0],[9,2,8,0],[10,2,9,0],[11,2,10,0],[12,2,11,0],[13,2,12,0],[14,2,13,0],[15,2,14,0],[16,2,15,0],[17,2,16,0],[18,2,17,0],[19,2,18,0],[20,2,19,0],[21,2,20,0],[22,2,21,0],[23,2,22,0],[24,2,23,0],[25,2,24,0],[26,2,25,0],[26,6,25,4,"safeNameCharacters"],[26,24,25,22],[26,27,25,25],[26,43,25,41],[27,2,26,0],[27,6,26,4,"knownSafeNames"],[27,20,26,18],[27,23,26,21],[27,27,26,25,"Set"],[27,30,26,28],[27,31,26,29],[27,32,26,30],[28,2,27,0],[28,11,27,9,"checkName"],[28,20,27,18,"checkName"],[28,21,27,19,"name"],[28,25,27,23],[28,27,27,25],[29,4,28,2],[29,8,28,6,"knownSafeNames"],[29,22,28,20],[29,23,28,21,"has"],[29,26,28,24],[29,27,28,25,"name"],[29,31,28,29],[29,32,28,30],[29,34,28,32],[30,6,29,4],[30,13,29,11,"name"],[30,17,29,15],[31,4,30,2],[32,4,31,2],[32,5,31,3],[32,6,31,4],[32,8,31,6,"_invariant"],[32,18,31,16],[32,19,31,17,"default"],[32,26,31,24],[32,28,31,26],[32,36,31,34],[32,41,31,39],[32,48,31,46,"name"],[32,52,31,50],[32,54,31,52],[32,69,31,67],[32,70,31,68,"concat"],[32,76,31,74],[32,77,31,75,"name"],[32,81,31,79],[32,83,31,81],[32,113,31,111],[32,114,31,112],[32,115,31,113],[33,4,32,2],[33,5,32,3],[33,6,32,4],[33,8,32,6,"_invariant"],[33,18,32,16],[33,19,32,17,"default"],[33,26,32,24],[33,28,32,26],[33,29,32,27],[33,30,32,28],[33,41,32,39],[33,43,32,41],[33,56,32,54],[33,58,32,56],[33,69,32,67],[33,71,32,69],[33,87,32,85],[33,89,32,87],[33,104,32,102],[33,106,32,104],[33,116,32,114],[33,118,32,116],[33,134,32,132],[33,136,32,134],[33,145,32,143],[33,146,32,144],[33,147,32,145,"includes"],[33,155,32,153],[33,156,32,154,"name"],[33,160,32,158],[33,161,32,159],[33,163,32,161],[33,178,32,176],[33,179,32,177,"concat"],[33,185,32,183],[33,186,32,184,"name"],[33,190,32,188],[33,192,32,190],[33,235,32,233],[33,236,32,234],[33,237,32,235],[34,4,33,2],[34,5,33,3],[34,6,33,4],[34,8,33,6,"_invariant"],[34,18,33,16],[34,19,33,17,"default"],[34,26,33,24],[34,28,33,26],[34,35,33,33],[34,40,33,38,"name"],[34,44,33,42],[34,45,33,43,"toLowerCase"],[34,56,33,54],[34,57,33,55],[34,58,33,56],[34,60,33,58],[34,75,33,73],[34,76,33,74,"concat"],[34,82,33,80],[34,83,33,81,"name"],[34,87,33,85],[34,89,33,87],[34,140,33,138],[34,141,33,139],[34,142,33,140],[35,4,34,2],[35,5,34,3],[35,6,34,4],[35,8,34,6,"_invariant"],[35,18,34,16],[35,19,34,17,"default"],[35,26,34,24],[35,28,34,26],[35,29,34,27],[35,30,34,28],[35,37,34,35],[35,39,34,37],[35,44,34,42],[35,46,34,44],[35,55,34,53],[35,57,34,55],[35,72,34,70],[35,73,34,71],[35,74,34,72,"includes"],[35,82,34,80],[35,83,34,81,"name"],[35,87,34,85],[35,88,34,86,"toLowerCase"],[35,99,34,97],[35,100,34,98],[35,101,34,99],[35,102,34,100],[35,104,34,102],[35,119,34,117],[35,120,34,118,"concat"],[35,126,34,124],[35,127,34,125,"name"],[35,131,34,129],[35,133,34,131],[35,184,34,182],[35,185,34,183],[35,186,34,184],[36,4,35,2],[36,5,35,3],[36,6,35,4],[36,8,35,6,"_invariant"],[36,18,35,16],[36,19,35,17,"default"],[36,26,35,24],[36,28,35,26],[36,29,35,27,"name"],[36,33,35,31],[36,34,35,32,"toLowerCase"],[36,45,35,43],[36,46,35,44],[36,47,35,45],[36,48,35,46,"startsWith"],[36,58,35,56],[36,59,35,57],[36,72,35,70],[36,73,35,71],[36,75,35,73],[36,90,35,88],[36,91,35,89,"concat"],[36,97,35,95],[36,98,35,96,"name"],[36,102,35,100],[36,104,35,102],[36,155,35,153],[36,156,35,154],[36,157,35,155],[37,4,36,2],[37,5,36,3],[37,6,36,4],[37,8,36,6,"_invariant"],[37,18,36,16],[37,19,36,17,"default"],[37,26,36,24],[37,28,36,26],[37,29,36,27,"name"],[37,33,36,31],[37,34,36,32,"startsWith"],[37,44,36,42],[37,45,36,43],[37,49,36,47],[37,50,36,48],[37,52,36,50],[37,67,36,65],[37,68,36,66,"concat"],[37,74,36,72],[37,75,36,73,"name"],[37,79,36,77],[37,81,36,79],[37,158,36,156],[37,159,36,157],[37,160,36,158],[38,4,37,2],[38,5,37,3],[38,6,37,4],[38,8,37,6,"_invariant"],[38,18,37,16],[38,19,37,17,"default"],[38,26,37,24],[38,28,37,26,"safeNameCharacters"],[38,46,37,44],[38,47,37,45,"test"],[38,51,37,49],[38,52,37,50,"name"],[38,56,37,54],[38,57,37,55],[38,59,37,57],[38,74,37,72],[38,75,37,73,"concat"],[38,81,37,79],[38,82,37,80,"name"],[38,86,37,84],[38,88,37,86],[38,145,37,143],[38,146,37,144],[38,147,37,145,"concat"],[38,153,37,151],[38,154,37,152,"safeNameCharacters"],[38,172,37,170],[38,173,37,171,"toString"],[38,181,37,179],[38,182,37,180],[38,183,37,181],[38,185,37,183],[38,188,37,186],[38,189,37,187],[38,190,37,188],[39,4,38,2,"knownSafeNames"],[39,18,38,16],[39,19,38,17,"add"],[39,22,38,20],[39,23,38,21,"name"],[39,27,38,25],[39,28,38,26],[40,4,39,2],[40,11,39,9,"name"],[40,15,39,13],[41,2,40,0],[42,0,40,1],[42,3]],"functionMap":{"names":["<global>","checkName"],"mappings":"AAA;AC0B"},"hasCjsExports":true},"type":"js/module"}]}