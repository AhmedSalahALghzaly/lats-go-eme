{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":29,"index":44},"end":{"line":3,"column":84,"index":99}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"../../common/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":40,"index":194},"end":{"line":6,"column":73,"index":227}}],"key":"Lyt2WLsYCohNU3fs70uAtDNxU1A=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _slicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\").default;\n  var _interopRequireDefault = require(_dependencyMap[1], \"@babel/runtime/helpers/interopRequireDefault\");\n  exports.__esModule = true;\n  exports.default = void 0;\n  var _invariant = _interopRequireDefault(require(_dependencyMap[2], \"../../common/invariant\"));\n  // A subscribable that implements the equivalent of:\n  // multicast(() => new ReplaySubject(1)) |> refCount Rx operation\n  //\n  // In other words:\n  // - Upon subscription, the source subscribable is subscribed to,\n  //   and its notifications are passed to subscribers here.\n  // - Multiple subscribers only cause a single subscription of the source\n  // - When last subscriber unsubscribes, the source is unsubscribed\n  // - Upon subscription, the subscriber receives last value sent by source (if any)\n  var SharedSubscribable = exports.default = /*#__PURE__*/function () {\n    function SharedSubscribable(source) {\n      this._unsubscribeSource = null;\n      this._subscribers = [];\n      this._didEmit = false;\n      this._lastValue = null;\n      this._source = source;\n    }\n    var _proto = SharedSubscribable.prototype;\n    _proto.subscribe = function (subscriber, debugInfo) {\n      var _this = this;\n      var entry = [subscriber, debugInfo];\n      this._subscribers.push(entry);\n      if (this._didEmit) {\n        subscriber(this._lastValue);\n      }\n      if (1 === this._subscribers.length) {\n        // TODO: What if this throws?\n        this._unsubscribeSource = this._source(function (value) {\n          return _this._notify(value);\n        });\n      }\n      return function () {\n        return _this._unsubscribe(entry);\n      };\n    };\n    _proto._notify = function (value) {\n      (0, _invariant.default)(this._subscribers.length, \"SharedSubscribable's source emitted a value after it was unsubscribed from\");\n      this._didEmit = true;\n      this._lastValue = value;\n      this._subscribers.forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 1),\n          subscriber = _ref2[0];\n        subscriber(value);\n      });\n    };\n    _proto._unsubscribe = function (entry) {\n      var idx = this._subscribers.indexOf(entry);\n      -1 !== idx && this._subscribers.splice(idx, 1);\n      if (!this._subscribers.length) {\n        var unsubscribe = this._unsubscribeSource;\n        this._unsubscribeSource = null;\n        this._didEmit = false;\n        unsubscribe && unsubscribe();\n      }\n    };\n    return SharedSubscribable;\n  }();\n});","lineCount":66,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_slicedToArray"],[4,20,1,13],[4,23,1,13,"require"],[4,30,1,13],[4,31,1,13,"_dependencyMap"],[4,45,1,13],[4,90,1,13,"default"],[4,97,1,13],[5,2,3,0],[5,6,3,4,"_interopRequireDefault"],[5,28,3,26],[5,31,3,29,"require"],[5,38,3,36],[5,39,3,36,"_dependencyMap"],[5,53,3,36],[5,104,3,83],[5,105,3,84],[6,2,4,0,"exports"],[6,9,4,7],[6,10,4,8,"__esModule"],[6,20,4,18],[6,23,4,21],[6,27,4,25],[7,2,5,0,"exports"],[7,9,5,7],[7,10,5,8,"default"],[7,17,5,15],[7,20,5,18],[7,25,5,23],[7,26,5,24],[8,2,6,0],[8,6,6,4,"_invariant"],[8,16,6,14],[8,19,6,17,"_interopRequireDefault"],[8,41,6,39],[8,42,6,40,"require"],[8,49,6,47],[8,50,6,47,"_dependencyMap"],[8,64,6,47],[8,93,6,72],[8,94,6,73],[8,95,6,74],[9,2,7,0],[10,2,8,0],[11,2,9,0],[12,2,10,0],[13,2,11,0],[14,2,12,0],[15,2,13,0],[16,2,14,0],[17,2,15,0],[18,2,16,0],[18,6,16,4,"SharedSubscribable"],[18,24,16,22],[18,27,16,25,"exports"],[18,34,16,32],[18,35,16,33,"default"],[18,42,16,40],[18,45,16,43],[18,58,16,56],[18,70,16,68],[19,4,17,2],[19,13,17,11,"SharedSubscribable"],[19,31,17,29,"SharedSubscribable"],[19,32,17,30,"source"],[19,38,17,36],[19,40,17,38],[20,6,18,4],[20,10,18,8],[20,11,18,9,"_unsubscribeSource"],[20,29,18,27],[20,32,18,30],[20,36,18,34],[21,6,19,4],[21,10,19,8],[21,11,19,9,"_subscribers"],[21,23,19,21],[21,26,19,24],[21,28,19,26],[22,6,20,4],[22,10,20,8],[22,11,20,9,"_didEmit"],[22,19,20,17],[22,22,20,20],[22,27,20,25],[23,6,21,4],[23,10,21,8],[23,11,21,9,"_lastValue"],[23,21,21,19],[23,24,21,22],[23,28,21,26],[24,6,22,4],[24,10,22,8],[24,11,22,9,"_source"],[24,18,22,16],[24,21,22,19,"source"],[24,27,22,25],[25,4,23,2],[26,4,24,2],[26,8,24,6,"_proto"],[26,14,24,12],[26,17,24,15,"SharedSubscribable"],[26,35,24,33],[26,36,24,34,"prototype"],[26,45,24,43],[27,4,25,2,"_proto"],[27,10,25,8],[27,11,25,9,"subscribe"],[27,20,25,18],[27,23,25,21],[27,33,25,31,"subscriber"],[27,43,25,41],[27,45,25,43,"debugInfo"],[27,54,25,52],[27,56,25,54],[28,6,26,4],[28,10,26,8,"_this"],[28,15,26,13],[28,18,26,16],[28,22,26,20],[29,6,27,4],[29,10,27,8,"entry"],[29,15,27,13],[29,18,27,16],[29,19,27,17,"subscriber"],[29,29,27,27],[29,31,27,29,"debugInfo"],[29,40,27,38],[29,41,27,39],[30,6,28,4],[30,10,28,8],[30,11,28,9,"_subscribers"],[30,23,28,21],[30,24,28,22,"push"],[30,28,28,26],[30,29,28,27,"entry"],[30,34,28,32],[30,35,28,33],[31,6,29,4],[31,10,29,8],[31,14,29,12],[31,15,29,13,"_didEmit"],[31,23,29,21],[31,25,29,23],[32,8,30,6,"subscriber"],[32,18,30,16],[32,19,30,17],[32,23,30,21],[32,24,30,22,"_lastValue"],[32,34,30,32],[32,35,30,33],[33,6,31,4],[34,6,32,4],[34,10,32,8],[34,11,32,9],[34,16,32,14],[34,20,32,18],[34,21,32,19,"_subscribers"],[34,33,32,31],[34,34,32,32,"length"],[34,40,32,38],[34,42,32,40],[35,8,33,6],[36,8,34,6],[36,12,34,10],[36,13,34,11,"_unsubscribeSource"],[36,31,34,29],[36,34,34,32],[36,38,34,36],[36,39,34,37,"_source"],[36,46,34,44],[36,47,34,45],[36,57,34,55,"value"],[36,62,34,60],[36,64,34,62],[37,10,35,8],[37,17,35,15,"_this"],[37,22,35,20],[37,23,35,21,"_notify"],[37,30,35,28],[37,31,35,29,"value"],[37,36,35,34],[37,37,35,35],[38,8,36,6],[38,9,36,7],[38,10,36,8],[39,6,37,4],[40,6,38,4],[40,13,38,11],[40,25,38,23],[41,8,39,6],[41,15,39,13,"_this"],[41,20,39,18],[41,21,39,19,"_unsubscribe"],[41,33,39,31],[41,34,39,32,"entry"],[41,39,39,37],[41,40,39,38],[42,6,40,4],[42,7,40,5],[43,4,41,2],[43,5,41,3],[44,4,42,2,"_proto"],[44,10,42,8],[44,11,42,9,"_notify"],[44,18,42,16],[44,21,42,19],[44,31,42,29,"value"],[44,36,42,34],[44,38,42,36],[45,6,43,4],[45,7,43,5],[45,8,43,6],[45,10,43,8,"_invariant"],[45,20,43,18],[45,21,43,19,"default"],[45,28,43,26],[45,30,43,28],[45,34,43,32],[45,35,43,33,"_subscribers"],[45,47,43,45],[45,48,43,46,"length"],[45,54,43,52],[45,56,43,54],[45,132,43,130],[45,133,43,131],[46,6,44,4],[46,10,44,8],[46,11,44,9,"_didEmit"],[46,19,44,17],[46,22,44,20],[46,26,44,24],[47,6,45,4],[47,10,45,8],[47,11,45,9,"_lastValue"],[47,21,45,19],[47,24,45,22,"value"],[47,29,45,27],[48,6,46,4],[48,10,46,8],[48,11,46,9,"_subscribers"],[48,23,46,21],[48,24,46,22,"forEach"],[48,31,46,29],[48,32,46,30],[48,42,46,30,"_ref"],[48,46,46,30],[48,48,46,54],[49,8,46,54],[49,12,46,54,"_ref2"],[49,17,46,54],[49,20,46,54,"_slicedToArray"],[49,34,46,54],[49,35,46,54,"_ref"],[49,39,46,54],[50,10,46,41,"subscriber"],[50,20,46,51],[50,23,46,51,"_ref2"],[50,28,46,51],[51,8,47,6,"subscriber"],[51,18,47,16],[51,19,47,17,"value"],[51,24,47,22],[51,25,47,23],[52,6,48,4],[52,7,48,5],[52,8,48,6],[53,4,49,2],[53,5,49,3],[54,4,50,2,"_proto"],[54,10,50,8],[54,11,50,9,"_unsubscribe"],[54,23,50,21],[54,26,50,24],[54,36,50,34,"entry"],[54,41,50,39],[54,43,50,41],[55,6,51,4],[55,10,51,8,"idx"],[55,13,51,11],[55,16,51,14],[55,20,51,18],[55,21,51,19,"_subscribers"],[55,33,51,31],[55,34,51,32,"indexOf"],[55,41,51,39],[55,42,51,40,"entry"],[55,47,51,45],[55,48,51,46],[56,6,52,4],[56,7,52,5],[56,8,52,6],[56,13,52,11,"idx"],[56,16,52,14],[56,20,52,18],[56,24,52,22],[56,25,52,23,"_subscribers"],[56,37,52,35],[56,38,52,36,"splice"],[56,44,52,42],[56,45,52,43,"idx"],[56,48,52,46],[56,50,52,48],[56,51,52,49],[56,52,52,50],[57,6,53,4],[57,10,53,8],[57,11,53,9],[57,15,53,13],[57,16,53,14,"_subscribers"],[57,28,53,26],[57,29,53,27,"length"],[57,35,53,33],[57,37,53,35],[58,8,54,6],[58,12,54,10,"unsubscribe"],[58,23,54,21],[58,26,54,24],[58,30,54,28],[58,31,54,29,"_unsubscribeSource"],[58,49,54,47],[59,8,55,6],[59,12,55,10],[59,13,55,11,"_unsubscribeSource"],[59,31,55,29],[59,34,55,32],[59,38,55,36],[60,8,56,6],[60,12,56,10],[60,13,56,11,"_didEmit"],[60,21,56,19],[60,24,56,22],[60,29,56,27],[61,8,57,6,"unsubscribe"],[61,19,57,17],[61,23,57,21,"unsubscribe"],[61,34,57,32],[61,35,57,33],[61,36,57,34],[62,6,58,4],[63,4,59,2],[63,5,59,3],[64,4,60,2],[64,11,60,9,"SharedSubscribable"],[64,29,60,27],[65,2,61,0],[65,3,61,1],[65,4,61,2],[65,5,61,3],[66,0,61,4],[66,3]],"functionMap":{"names":["<global>","<anonymous>","SharedSubscribable","_proto.subscribe","_source$argument_0","_proto._notify","_subscribers.forEach$argument_0","_proto._unsubscribe"],"mappings":"AAA;wDCe;ECC;GDM;qBEE;6CCS;ODE;WFE;KEE;GFC;mBIC;8BCI;KDE;GJC;wBMC;GNS;CDE"},"hasCjsExports":true},"type":"js/module"}]}